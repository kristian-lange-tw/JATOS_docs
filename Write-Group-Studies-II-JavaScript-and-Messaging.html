<!doctype html>
<html class="docs-version-3.6.1" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<title data-react-helmet="true">Write Group Studies II - JavaScript and Messaging | JATOS</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://www.jatos.org/Write-Group-Studies-II-JavaScript-and-Messaging.html"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="3.6.1"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-3.6.1"><meta data-react-helmet="true" property="og:title" content="Write Group Studies II - JavaScript and Messaging | JATOS"><meta data-react-helmet="true" name="description" content="Writing JavaScripts for group studies"><meta data-react-helmet="true" property="og:description" content="Writing JavaScripts for group studies"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.jatos.org/Write-Group-Studies-II-JavaScript-and-Messaging.html"><link data-react-helmet="true" rel="alternate" href="https://www.jatos.org/Write-Group-Studies-II-JavaScript-and-Messaging.html" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.jatos.org/Write-Group-Studies-II-JavaScript-and-Messaging.html" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.6a5cc3b5.css">
<link rel="preload" href="/assets/js/runtime~main.4b35aa90.js" as="script">
<link rel="preload" href="/assets/js/main.3775ad8c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/jatos_logo_color.svg" alt="JATOS Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/jatos_logo_color.svg" alt="JATOS Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">JATOS</b></a><a class="navbar__item navbar__link navbar__link--active" href="/Whats-JATOS.html">Documentation</a><a class="navbar__item navbar__link" href="/Example-Studies">Example Studies</a><a class="navbar__item navbar__link navbar__link--active" href="/Contact-us.html">Contact</a></div><div class="navbar__items navbar__items--right"><a href="https://ko-fi.com/jatos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support us</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/Whats-JATOS.html">3.6.1 and earlier</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/3.7.1/Write-Group-Studies-II-JavaScript-and-Messaging.html">3.7.1-alpha</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/Write-Group-Studies-II-JavaScript-and-Messaging.html">3.6.1 and earlier</a></li></ul></div><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/Whats-JATOS.html">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/Create-a-new-study.html">Write your study</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/Deploy-to-a-server-installation.html">Run your study</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/Administration.html">Manage your JATOS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/Example-Group-Studies.html">Group studies</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Example-Group-Studies.html">Example Group Studies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Write-Group-Studies-I-Setup.html">Write Group Studies I - Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Write-Group-Studies-II-JavaScript-and-Messaging.html">Write Group Studies II - JavaScript and Messaging</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/Bring-your-JATOS-online.html">Serving the Internet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/jatos.js-Reference.html">Reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->3.6.1 and earlier</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Write Group Studies II - JavaScript and Messaging</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="writing-javascripts-for-group-studies">Writing JavaScripts for group studies<a aria-hidden="true" class="hash-link" href="#writing-javascripts-for-group-studies" title="Direct link to heading">â€‹</a></h2><p>Group studies differ from single-worker studies simply in that the JavaScript needs to handle groups and communications between members. The jatos.js library provides some useful functions for this.</p><p>If you like to dive right into jatos.js&#x27; reference:</p><ul><li><a href="/jatos.js-Reference.html#functions-for-group-studies">jatos.js functions for group studies</a></li><li><a href="/jatos.js-Reference.html#group-variables">jatos.js group variables</a></li><li><a href="/jatos.js-Reference.html#functions-to-access-the-group-session">jatos.js Group Session functions</a></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="joining-a-group-and-opening-group-channels">Joining a group and opening group channels<a aria-hidden="true" class="hash-link" href="#joining-a-group-and-opening-group-channels" title="Direct link to heading">â€‹</a></h3><p>There are two requisites for allowing group members to interact:</p><ol><li><p>Workers can only communicate with members of their own group. So, interacting workers must all join the same group.
<strong>A worker will remain in a group until jatos.js is explicitly told to leave the group (or the study run is finished). This means that if a worker moves between components or reloads a page they will remain in the same group.</strong> This feature makes groups much more robust. </p></li><li><p>Communication can only be done if a group channel is open. Although jatos.js opens and closes all necessary group channels so you don&#x27;t have to care for them directly while writing components. Group channels in turn use <a href="https://en.wikipedia.org/wiki/WebSocket" target="_blank" rel="noopener noreferrer">WebSockets</a>. WebSockets are supported by <a href="http://caniuse.com/#feat=websockets" target="_blank" rel="noopener noreferrer">all modern browsers</a>. </p></li></ol><p>So here&#x27;s how a typical JATOS group study run would look like:</p><p>Component 1</p><ul><li><em>jatos.joinGroup</em> -&gt; joins group and opens group channel</li><li><em>jatos.nextComponent</em> -&gt; closes group channel and jumps to next component</li></ul><p>Component 2</p><ul><li><em>jatos.joinGroup</em> -&gt; opens group channel in the <strong>same group</strong></li><li><em>jatos.nextComponent</em> -&gt; closes group channel and jumps to next component</li></ul><p>Component 3</p><ul><li><em>jatos.joinGroup</em> -&gt; opens group channel <strong>same group</strong></li><li><em>jatos.endStudy</em> -&gt; closes group channel, leaves group, ends component, and ends study</li></ul><p>Notice that by calling <em><a href="/jatos.js-Reference.html#jatosjoingroupcallbacks">jatos.joinGroup</a></em> in the second and third component JATOS does not let workers join a new group but just  opens a group channel in the already joined group. To make a worker leave a group,  use the function <a href="/jatos.js-Reference.html#jatosleavegroup"><em>jatos.leaveGroup</em></a>.</p><p>Every know and then you probably would like to know who the members of your groups are. This and other stats you can get by clicking on your batch&#x27;s <a href="/Run-your-Study-with-Worker-and-Batch-Manager.html#groups-since-v331"><strong>Groups</strong> button in the Worker &amp; Batch Manger</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="reassigning-to-a-different-group">Reassigning to a different group<a aria-hidden="true" class="hash-link" href="#reassigning-to-a-different-group" title="Direct link to heading">â€‹</a></h3><p>To move a worker from one group to a different one, use <a href="/jatos.js-Reference.html#jatosreassigngroup"><em>jatos.reassignGroup</em></a>. This function will make a worker leave their group and join a different one. JATOS can only reassign to a different group if there is another group available. If there is no other group JATOS will not start a new one but put the worker into the same old group again.  </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fixing-a-group">Fixing a group<a aria-hidden="true" class="hash-link" href="#fixing-a-group" title="Direct link to heading">â€‹</a></h3><p>Sometimes you want to stay with the group like it is in the moment and don&#x27;t let new members join - although it would be allowed according to the group properties. For example in the <a href="/Example-Studies.html#prisoners-dilemma">Prisoner&#x27;s Example study</a> after the group is assembled in the waiting room component it is necessary to keep the two members as it is. Even if one of the members leaves in the middle of the game, JATOS shouldn&#x27;t just assign a new member. To do this you can call jatos.js&#x27; function <a href="/jatos.js-Reference.html#jatossetgroupfixed"><em>jatos.setGroupFixed</em></a>. Alternatively (since JATOS &gt;= v3.4.1) you can fix a group in JATOS&#x27; GUI, in the <a href="/Run-your-Study-with-Worker-and-Batch-Manager.html#groups-since-v331">groups table</a>. </p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="communication-between-group-members">Communication between group members<a aria-hidden="true" class="hash-link" href="#communication-between-group-members" title="Direct link to heading">â€‹</a></h2><p>JATOS provides three ways for communicating within the group: direct messaging, broadcast messaging and via the Group Session.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="direct-messaging">Direct messaging<a aria-hidden="true" class="hash-link" href="#direct-messaging" title="Direct link to heading">â€‹</a></h3><p>Members can send direct messages to a single other member of the same group with the <a href="/jatos.js-Reference.html#jatossendgroupmsgto"><em>jatos.sendGroupMsgTo</em></a> function. Like broadcast messaging this way of group communication is fast but can be unreliable in case of an unstable network connection. We use direct messaging in the <a href="/Example-Studies.html#snake">Snake example</a> to send the coordinates of the snakes on every step. Here, speed is more critical than reliability in the messages, because a few dropped frames will probably go unnoticed. </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="broadcast-messaging">Broadcast messaging<a aria-hidden="true" class="hash-link" href="#broadcast-messaging" title="Direct link to heading">â€‹</a></h3><p>Members can send messages to all other members of the same group with the <a href="/jatos.js-Reference.html#jatossendgroupmsg"><em>jatos.sendGroupMsg</em></a> function. Like direct messaging this way of group communication is fast but can be unreliable in case of an unstable network connection.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="group-session">Group session<a aria-hidden="true" class="hash-link" href="#group-session" title="Direct link to heading">â€‹</a></h3><p>The Group Session is one of the <a href="/Session-Data-Three-Types.html">three types of session that JATOS provides</a>. Members can access the Group Session data with the <a href="/jatos.js-Reference.html#functions-to-access-the-group-session">Group Session functions</a>. The Group Session data are stored in JATOS&#x27; database <strong>only while the group is active. It is deleted when the group is finished.</strong> Communication via Group Session is slower, but more reliable than group messaging. If one member has an unstable internet connection or does a page reload, the Group Session will be automatically restored after the member reopens the group channel. Workers communicate via the Group Session data in the <a href="/Example-Studies.html#prisoners-dilemma">Prisoner&#x27;s Example study</a>, because here one dropped message would lead to important information loss.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/JATOS/JATOS_docs/tree/master/versioned_docs/version-3.6.1/Group_studies/Write-Group-Studies-II-JavaScript-and-Messaging.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-01-05T21:42:52.000Z">1/5/2022</time></b> by <b>Kristian Lange</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Write-Group-Studies-I-Setup.html"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Write Group Studies I - Setup</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Bring-your-JATOS-online.html"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Bring your JATOS online<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#writing-javascripts-for-group-studies" class="table-of-contents__link toc-highlight">Writing JavaScripts for group studies</a><ul><li><a href="#joining-a-group-and-opening-group-channels" class="table-of-contents__link toc-highlight">Joining a group and opening group channels</a></li><li><a href="#reassigning-to-a-different-group" class="table-of-contents__link toc-highlight">Reassigning to a different group</a></li><li><a href="#fixing-a-group" class="table-of-contents__link toc-highlight">Fixing a group</a></li></ul></li><li><a href="#communication-between-group-members" class="table-of-contents__link toc-highlight">Communication between group members</a><ul><li><a href="#direct-messaging" class="table-of-contents__link toc-highlight">Direct messaging</a></li><li><a href="#broadcast-messaging" class="table-of-contents__link toc-highlight">Broadcast messaging</a></li><li><a href="#group-session" class="table-of-contents__link toc-highlight">Group session</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://forum.cogsci.nl/categories/jatos" target="_blank" rel="noopener noreferrer" class="footer__link-item">JATOS Forum</a></li><li class="footer__item"><a href="https://groups.google.com/g/jatos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Group</a></li><li class="footer__item"><a href="https://github.com/JATOS/JATOS/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issues</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="http://blog.jatos.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/JATOS/JATOS" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">JATOS is free and <a href="https://github.com/JATOS/JATOS" class="footer__link-item">open source</a> and published under <a href="https://www.apache.org/licenses/LICENSE-2.0" class="footer__link-item">Apache License, version 2.0</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.4b35aa90.js"></script>
<script src="/assets/js/main.3775ad8c.js"></script>
</body>
</html>